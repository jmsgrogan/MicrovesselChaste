<!DOCTYPE html>
<html>
  <head>

    <title>Test Solving Pdes Tutorial | Microvessel Chaste</title>
    
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>

      <!--<link rel="icon" type="image/png" href="https://jmsgrogan.github.io/MicrovesselChaste/resources/favicon.ico">-->
      <!--<link rel="shortcut icon" type="image/png" href="https://jmsgrogan.github.io/MicrovesselChaste/resources/favicon.ico">-->

    <!-- prettify CSS (corresponding js at footer)-->
    <link rel="stylesheet" href="https://jmsgrogan.github.io/MicrovesselChaste/resources/css/prettify.css" type="text/css" />

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://jmsgrogan.github.io/MicrovesselChaste/resources/css/bootstrap.css" type="text/css" />

    <link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:400,600,700,900,400italic,700italic' rel='stylesheet' type='text/css'>

    <!-- Custom stylesheet -->
    <link rel="stylesheet" href="https://jmsgrogan.github.io/MicrovesselChaste/resources/css/main.css" type="text/css" />

    <!-- Typekit (should stay at top of page, do not move to footer)-->
    <script type="text/javascript" src="//use.typekit.net/abh3wgk.js"></script>
    <script type="text/javascript">try{Typekit.load();}catch(e){}</script>

    <!-- Atom feeds -->
    <link rel="alternate" type="application/atom+xml" title="News Feed" href="https://jmsgrogan.github.io/MicrovesselChaste/feed/index.xml" />
    <link rel="alternate" type="application/atom+xml" title="Blog Feed" href="https://jmsgrogan.github.io/MicrovesselChaste/feed/blog.xml" />


  </head>
  <body>


<div class="darkstrip"></div>

<div class="darkbluetopbar">
  <div class="container" style="height: 100%">
    <div class="navbar-wrap">
      <div class="container" style="position: relative; height: 100%;">
        <div class="scala-logo">
          <a href="https://jmsgrogan.github.io/MicrovesselChaste/index.html"><img src="https://jmsgrogan.github.io/MicrovesselChaste/resources/img/mvc_logo_25.png" alt="Microvessel Chaste Logo" />
        </div>
        <ul class="nav">
  <li><a href="https://jmsgrogan.github.io/MicrovesselChaste/documentation/">Documentation</a></li>
  <li><a href="https://jmsgrogan.github.io/MicrovesselChaste/documentation/installation.html">Download</a></li>
  <li><a href="https://jmsgrogan.github.io/MicrovesselChaste/community/">Community</a></li>
  <li><a href="https://jmsgrogan.github.io/MicrovesselChaste/contribute/">Contribute</a></li>
  <li id="source-code" >
    <a href="https://github.com/jmsgrogan/MicrovesselChaste"><img src="https://jmsgrogan.github.io/MicrovesselChaste/resources/img/github-logo.png" alt="GitHub Logo" /></a>
    <div class="toptip">Source Code</div>
  </li>
  <li id="scala-lang-twitter">
    <a href="https://twitter.com/chaste_project"><img src="https://jmsgrogan.github.io/MicrovesselChaste/resources/img/twitter-logo-white.png" alt="Twitter Logo" /></a>
    <div class="toptip">Chaste on Twitter</div>
  </li>
</ul>

      </div>
    </div>
  </div>
</div>

<div class="midbluebar">
  <div class="container">
    <h1 id="page-title">Test Solving Pdes Tutorial</h1>
  </div>
</div>

<div class="page-container">
  <div class="container" style="min-height: 540px;">
    <div class="row">
      <div class="span12">
          <div class="main-page-column" style="width: 100%;">
            
            <p>This tutorial is automatically generated from the file test/tutorials//TestSolvingPdesTutorial.hpp.
Note that the code is given in full at the bottom of the page.</p>

<h1>Solving PDEs in the Microvessel Project</h1>

<p>This tutorial demonstrates methods for solving PDEs in the Microvessel Project. It is noted
that the way to set up PDEs differs from that of Cell Based Chaste, although the same solver
can be used behind the scenes.</p>

<p>The following is covered:
 * Solving a linear reaction-diffusion PDE with finite differences.
 * Solving a linear reaction-diffusion PDE with finite finite elements and discrete sinks and sources.
 * Solving a non-linear reaction-diffusion PDE with finite differences.
 * Solving a linear reaction-diffusion PDE using Green&#39;s functions.
 * Interacting with regular grids and finite element meshes.</p>

<h1>The Test</h1>

<p>Start by introducing the necessary header files. The first contain functionality for setting up unit tests,
smart pointer tools and output management.</p>
<div class="highlight"><pre><code class="language-cpp" data-lang="cpp"><span class="cp">#include &lt;cxxtest/TestSuite.h&gt;
#include "AbstractCellBasedWithTimingsTestSuite.hpp"
#include "SmartPointers.hpp"
#include "OutputFileHandler.hpp"
#include "FileFinder.hpp"
</span></code></pre></div>
<p>Dimensional analysis.</p>
<div class="highlight"><pre><code class="language-cpp" data-lang="cpp"><span class="cp">#include "DimensionalChastePoint.hpp"
#include "UnitCollection.hpp"
#include "Owen11Parameters.hpp"
#include "GenericParameters.hpp"
#include "ParameterCollection.hpp"
#include "BaseUnits.hpp"
</span></code></pre></div>
<p>Geometry tools.</p>
<div class="highlight"><pre><code class="language-cpp" data-lang="cpp"><span class="cp">#include "MappableGridGenerator.hpp"
#include "Part.hpp"
</span></code></pre></div>
<p>Vessel networks.</p>
<div class="highlight"><pre><code class="language-cpp" data-lang="cpp"><span class="cp">#include "VesselNetwork.hpp"
#include "VesselNetworkGenerator.hpp"
</span></code></pre></div>
<p>Grids and PDEs.</p>
<div class="highlight"><pre><code class="language-cpp" data-lang="cpp"><span class="cp">#include "DiscreteContinuumMesh.hpp"
#include "VtkMeshWriter.hpp"
#include "FiniteElementSolver.hpp"
#include "FiniteDifferenceSolver.hpp"
#include "DiscreteSource.hpp"
#include "VesselBasedDiscreteSource.hpp"
#include "DiscreteContinuumBoundaryCondition.hpp"
#include "LinearSteadyStateDiffusionReactionPde.hpp"
#include "MichaelisMentenSteadyStateDiffusionReactionPde.hpp"
</span></code></pre></div>
<p>This should appear last.</p>
<div class="highlight"><pre><code class="language-cpp" data-lang="cpp"><span class="cp">#include "PetscSetupAndFinalize.hpp"
</span><span class="k">class</span> <span class="nc">TestSolvingPdesLiteratePaper</span> <span class="o">:</span> <span class="k">public</span> <span class="n">AbstractCellBasedWithTimingsTestSuite</span>
<span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
</code></pre></div>
<h2>Test 1 - Linear Reaction Diffusion With Finite Differences =</h2>

<p>In the first example we will solve a steady-state linear reaction diffusion
PDE with finite differences.</p>
<div class="highlight"><pre><code class="language-cpp" data-lang="cpp">    <span class="kt">void</span> <span class="nf">TestLinearReactionDiffusionPdeWithFiniteDifferences</span><span class="p">()</span> <span class="k">throw</span><span class="p">(</span><span class="n">Exception</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">MAKE_PTR_ARGS</span><span class="p">(</span><span class="n">OutputFileHandler</span><span class="p">,</span> <span class="n">p_handler</span><span class="p">,</span> <span class="p">(</span><span class="s">"TestSolvingPdesLiteratePaper/TestLinearReactionDiffusionPdeWithFiniteDifferences"</span><span class="p">));</span>
</code></pre></div>
<p>We will work in microns</p>
<div class="highlight"><pre><code class="language-cpp" data-lang="cpp">        <span class="n">units</span><span class="o">::</span><span class="n">quantity</span><span class="o">&lt;</span><span class="n">unit</span><span class="o">::</span><span class="n">length</span><span class="o">&gt;</span> <span class="n">reference_length</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">*</span> <span class="n">unit</span><span class="o">::</span><span class="n">microns</span><span class="p">);</span>
        <span class="n">BaseUnits</span><span class="o">::</span><span class="n">Instance</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">SetReferenceLengthScale</span><span class="p">(</span><span class="n">reference_length</span><span class="p">);</span>
</code></pre></div>
<p>Set up a simulation domain, which will be a cuboid.</p>
<div class="highlight"><pre><code class="language-cpp" data-lang="cpp">        <span class="n">units</span><span class="o">::</span><span class="n">quantity</span><span class="o">&lt;</span><span class="n">unit</span><span class="o">::</span><span class="n">length</span><span class="o">&gt;</span> <span class="n">domain_width</span><span class="p">(</span><span class="mf">100.0</span> <span class="o">*</span> <span class="mf">1.e-6</span> <span class="o">*</span> <span class="n">unit</span><span class="o">::</span><span class="n">microns</span><span class="p">);</span>
        <span class="n">units</span><span class="o">::</span><span class="n">quantity</span><span class="o">&lt;</span><span class="n">unit</span><span class="o">::</span><span class="n">length</span><span class="o">&gt;</span> <span class="n">domain_height</span><span class="p">(</span><span class="mf">100.0</span> <span class="o">*</span> <span class="mf">1.e-6</span> <span class="o">*</span> <span class="n">unit</span><span class="o">::</span><span class="n">microns</span><span class="p">);</span>
        <span class="n">units</span><span class="o">::</span><span class="n">quantity</span><span class="o">&lt;</span><span class="n">unit</span><span class="o">::</span><span class="n">length</span><span class="o">&gt;</span> <span class="n">domain_depth</span><span class="p">(</span><span class="mf">20.0</span> <span class="o">*</span> <span class="mf">1.e-6</span> <span class="o">*</span> <span class="n">unit</span><span class="o">::</span><span class="n">microns</span><span class="p">);</span>
        <span class="n">boost</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">Part</span><span class="o">&lt;</span><span class="mi">3</span><span class="o">&gt;</span> <span class="o">&gt;</span> <span class="n">p_domain</span> <span class="o">=</span> <span class="n">Part</span><span class="o">&lt;</span><span class="mi">3</span><span class="o">&gt;::</span><span class="n">Create</span><span class="p">();</span>
        <span class="n">p_domain</span><span class="o">-&gt;</span><span class="n">AddCuboid</span><span class="p">(</span><span class="n">domain_width</span><span class="p">,</span> <span class="n">domain_height</span><span class="p">,</span> <span class="n">domain_depth</span><span class="p">,</span> <span class="n">DimensionalChastePoint</span><span class="o">&lt;</span><span class="mi">3</span><span class="o">&gt;</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">));</span>
</code></pre></div>
<p>Make a regular grid on the domain</p>
<div class="highlight"><pre><code class="language-cpp" data-lang="cpp">        <span class="n">boost</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">RegularGrid</span><span class="o">&lt;</span><span class="mi">3</span><span class="o">&gt;</span> <span class="o">&gt;</span> <span class="n">p_grid</span> <span class="o">=</span> <span class="n">RegularGrid</span><span class="o">&lt;</span><span class="mi">3</span><span class="o">&gt;::</span><span class="n">Create</span><span class="p">();</span>
        <span class="n">p_grid</span><span class="o">-&gt;</span><span class="n">GenerateFromPart</span><span class="p">(</span><span class="n">p_domain</span><span class="p">,</span> <span class="mf">10.0</span><span class="o">*</span><span class="n">reference_length</span><span class="p">);</span>
</code></pre></div>
<p>Set up a PDE, we will model oxygen diffusion.</p>
<div class="highlight"><pre><code class="language-cpp" data-lang="cpp">        <span class="n">boost</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">LinearSteadyStateDiffusionReactionPde</span><span class="o">&lt;</span><span class="mi">3</span><span class="o">&gt;</span> <span class="o">&gt;</span> <span class="n">p_oxygen_pde</span> <span class="o">=</span> <span class="n">LinearSteadyStateDiffusionReactionPde</span><span class="o">&lt;</span><span class="mi">3</span><span class="o">&gt;::</span><span class="n">Create</span><span class="p">();</span>
        <span class="n">units</span><span class="o">::</span><span class="n">quantity</span><span class="o">&lt;</span><span class="n">unit</span><span class="o">::</span><span class="n">diffusivity</span><span class="o">&gt;</span> <span class="n">oxygen_diffusivity</span><span class="p">(</span><span class="mf">1.e-6</span><span class="o">*</span><span class="n">unit</span><span class="o">::</span><span class="n">metre_squared_per_second</span><span class="p">);</span>
        <span class="n">p_oxygen_pde</span><span class="o">-&gt;</span><span class="n">SetIsotropicDiffusionConstant</span><span class="p">(</span><span class="n">oxygen_diffusivity</span><span class="p">);</span>
</code></pre></div>
<p>Add continuum sink term for cells</p>
<div class="highlight"><pre><code class="language-cpp" data-lang="cpp">        <span class="n">units</span><span class="o">::</span><span class="n">quantity</span><span class="o">&lt;</span><span class="n">unit</span><span class="o">::</span><span class="n">rate</span><span class="o">&gt;</span> <span class="n">oxygen_consumption_rate</span><span class="p">(</span><span class="mf">1.e-6</span><span class="o">*</span><span class="n">unit</span><span class="o">::</span><span class="n">per_second</span><span class="p">);</span>
        <span class="n">p_oxygen_pde</span><span class="o">-&gt;</span><span class="n">SetContinuumLinearInUTerm</span><span class="p">(</span><span class="o">-</span><span class="n">oxygen_consumption_rate</span><span class="p">);</span>
</code></pre></div>
<p>Add a Dirichlet boundary condition on the left face of the domain.</p>
<div class="highlight"><pre><code class="language-cpp" data-lang="cpp">        <span class="n">p_domain</span><span class="o">-&gt;</span><span class="n">GetFacet</span><span class="p">(</span><span class="n">DimensionalChastePoint</span><span class="o">&lt;</span><span class="mi">3</span><span class="o">&gt;</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span>
                                                     <span class="n">domain_height</span><span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">reference_length</span><span class="p">),</span>
                                                     <span class="n">domain_depth</span><span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">reference_length</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">SetLabel</span><span class="p">(</span><span class="s">"boundary_1"</span><span class="p">);</span>
        <span class="n">boost</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">DiscreteContinuumBoundaryCondition</span><span class="o">&lt;</span><span class="mi">3</span><span class="o">&gt;</span> <span class="o">&gt;</span> <span class="n">p_left_face_boundary</span> <span class="o">=</span> <span class="n">DiscreteContinuumBoundaryCondition</span><span class="o">&lt;</span><span class="mi">3</span><span class="o">&gt;::</span><span class="n">Create</span><span class="p">();</span>
        <span class="n">p_left_face_boundary</span><span class="o">-&gt;</span><span class="n">SetType</span><span class="p">(</span><span class="n">BoundaryConditionType</span><span class="o">::</span><span class="n">FACET</span><span class="p">);</span>
        <span class="n">p_left_face_boundary</span><span class="o">-&gt;</span><span class="n">SetDomain</span><span class="p">(</span><span class="n">p_domain</span><span class="p">);</span>
        <span class="n">p_left_face_boundary</span><span class="o">-&gt;</span><span class="n">SetValue</span><span class="p">(</span><span class="mf">10.0</span><span class="o">*</span><span class="n">unit</span><span class="o">::</span><span class="n">mole_per_metre_cubed</span><span class="p">);</span>
        <span class="n">p_left_face_boundary</span><span class="o">-&gt;</span><span class="n">SetLabelName</span><span class="p">(</span><span class="s">"boundary_1"</span><span class="p">);</span>
</code></pre></div>
<p>Set up the PDE solvers for the oxygen problem</p>
<div class="highlight"><pre><code class="language-cpp" data-lang="cpp">        <span class="n">boost</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">FiniteDifferenceSolver</span><span class="o">&lt;</span><span class="mi">3</span><span class="o">&gt;</span> <span class="o">&gt;</span> <span class="n">p_oxygen_solver</span> <span class="o">=</span> <span class="n">FiniteDifferenceSolver</span><span class="o">&lt;</span><span class="mi">3</span><span class="o">&gt;::</span><span class="n">Create</span><span class="p">();</span>
        <span class="n">p_oxygen_solver</span><span class="o">-&gt;</span><span class="n">SetPde</span><span class="p">(</span><span class="n">p_oxygen_pde</span><span class="p">);</span>
        <span class="n">p_oxygen_solver</span><span class="o">-&gt;</span><span class="n">SetGrid</span><span class="p">(</span><span class="n">p_grid</span><span class="p">);</span>
        <span class="n">p_oxygen_solver</span><span class="o">-&gt;</span><span class="n">AddBoundaryCondition</span><span class="p">(</span><span class="n">p_left_face_boundary</span><span class="p">);</span>
        <span class="n">p_oxygen_solver</span><span class="o">-&gt;</span><span class="n">SetLabel</span><span class="p">(</span><span class="s">"oxygen"</span><span class="p">);</span>
        <span class="n">p_oxygen_solver</span><span class="o">-&gt;</span><span class="n">SetFileHandler</span><span class="p">(</span><span class="n">p_handler</span><span class="p">);</span>
        <span class="n">p_oxygen_solver</span><span class="o">-&gt;</span><span class="n">SetFileName</span><span class="p">(</span><span class="s">"fd_solution.vti"</span><span class="p">);</span>
        <span class="n">p_oxygen_solver</span><span class="o">-&gt;</span><span class="n">SetWriteSolution</span><span class="p">(</span><span class="nb">true</span><span class="p">);</span>
        <span class="n">p_oxygen_solver</span><span class="o">-&gt;</span><span class="n">Setup</span><span class="p">();</span>
        <span class="n">p_oxygen_solver</span><span class="o">-&gt;</span><span class="n">Solve</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">};</span>

</code></pre></div>
<h1>Code</h1>

<p>The full code is given below</p>

<h2>File name <code>TestSolvingPdesTutorial.hpp</code></h2>
<div class="highlight"><pre><code class="language-cpp" data-lang="cpp"><span class="cp">#include &lt;cxxtest/TestSuite.h&gt;
#include "AbstractCellBasedWithTimingsTestSuite.hpp"
#include "SmartPointers.hpp"
#include "OutputFileHandler.hpp"
#include "FileFinder.hpp"
#include "DimensionalChastePoint.hpp"
#include "UnitCollection.hpp"
#include "Owen11Parameters.hpp"
#include "GenericParameters.hpp"
#include "ParameterCollection.hpp"
#include "BaseUnits.hpp"
#include "MappableGridGenerator.hpp"
#include "Part.hpp"
#include "VesselNetwork.hpp"
#include "VesselNetworkGenerator.hpp"
#include "DiscreteContinuumMesh.hpp"
#include "VtkMeshWriter.hpp"
#include "FiniteElementSolver.hpp"
#include "FiniteDifferenceSolver.hpp"
#include "DiscreteSource.hpp"
#include "VesselBasedDiscreteSource.hpp"
#include "DiscreteContinuumBoundaryCondition.hpp"
#include "LinearSteadyStateDiffusionReactionPde.hpp"
#include "MichaelisMentenSteadyStateDiffusionReactionPde.hpp"
#include "PetscSetupAndFinalize.hpp"
</span><span class="k">class</span> <span class="nc">TestSolvingPdesLiteratePaper</span> <span class="o">:</span> <span class="k">public</span> <span class="n">AbstractCellBasedWithTimingsTestSuite</span>
<span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
    <span class="kt">void</span> <span class="n">TestLinearReactionDiffusionPdeWithFiniteDifferences</span><span class="p">()</span> <span class="k">throw</span><span class="p">(</span><span class="n">Exception</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">MAKE_PTR_ARGS</span><span class="p">(</span><span class="n">OutputFileHandler</span><span class="p">,</span> <span class="n">p_handler</span><span class="p">,</span> <span class="p">(</span><span class="s">"TestSolvingPdesLiteratePaper/TestLinearReactionDiffusionPdeWithFiniteDifferences"</span><span class="p">));</span>
        <span class="n">units</span><span class="o">::</span><span class="n">quantity</span><span class="o">&lt;</span><span class="n">unit</span><span class="o">::</span><span class="n">length</span><span class="o">&gt;</span> <span class="n">reference_length</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">*</span> <span class="n">unit</span><span class="o">::</span><span class="n">microns</span><span class="p">);</span>
        <span class="n">BaseUnits</span><span class="o">::</span><span class="n">Instance</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">SetReferenceLengthScale</span><span class="p">(</span><span class="n">reference_length</span><span class="p">);</span>
        <span class="n">units</span><span class="o">::</span><span class="n">quantity</span><span class="o">&lt;</span><span class="n">unit</span><span class="o">::</span><span class="n">length</span><span class="o">&gt;</span> <span class="n">domain_width</span><span class="p">(</span><span class="mf">100.0</span> <span class="o">*</span> <span class="mf">1.e-6</span> <span class="o">*</span> <span class="n">unit</span><span class="o">::</span><span class="n">microns</span><span class="p">);</span>
        <span class="n">units</span><span class="o">::</span><span class="n">quantity</span><span class="o">&lt;</span><span class="n">unit</span><span class="o">::</span><span class="n">length</span><span class="o">&gt;</span> <span class="n">domain_height</span><span class="p">(</span><span class="mf">100.0</span> <span class="o">*</span> <span class="mf">1.e-6</span> <span class="o">*</span> <span class="n">unit</span><span class="o">::</span><span class="n">microns</span><span class="p">);</span>
        <span class="n">units</span><span class="o">::</span><span class="n">quantity</span><span class="o">&lt;</span><span class="n">unit</span><span class="o">::</span><span class="n">length</span><span class="o">&gt;</span> <span class="n">domain_depth</span><span class="p">(</span><span class="mf">20.0</span> <span class="o">*</span> <span class="mf">1.e-6</span> <span class="o">*</span> <span class="n">unit</span><span class="o">::</span><span class="n">microns</span><span class="p">);</span>
        <span class="n">boost</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">Part</span><span class="o">&lt;</span><span class="mi">3</span><span class="o">&gt;</span> <span class="o">&gt;</span> <span class="n">p_domain</span> <span class="o">=</span> <span class="n">Part</span><span class="o">&lt;</span><span class="mi">3</span><span class="o">&gt;::</span><span class="n">Create</span><span class="p">();</span>
        <span class="n">p_domain</span><span class="o">-&gt;</span><span class="n">AddCuboid</span><span class="p">(</span><span class="n">domain_width</span><span class="p">,</span> <span class="n">domain_height</span><span class="p">,</span> <span class="n">domain_depth</span><span class="p">,</span> <span class="n">DimensionalChastePoint</span><span class="o">&lt;</span><span class="mi">3</span><span class="o">&gt;</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">));</span>
        <span class="n">boost</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">RegularGrid</span><span class="o">&lt;</span><span class="mi">3</span><span class="o">&gt;</span> <span class="o">&gt;</span> <span class="n">p_grid</span> <span class="o">=</span> <span class="n">RegularGrid</span><span class="o">&lt;</span><span class="mi">3</span><span class="o">&gt;::</span><span class="n">Create</span><span class="p">();</span>
        <span class="n">p_grid</span><span class="o">-&gt;</span><span class="n">GenerateFromPart</span><span class="p">(</span><span class="n">p_domain</span><span class="p">,</span> <span class="mf">10.0</span><span class="o">*</span><span class="n">reference_length</span><span class="p">);</span>
        <span class="n">boost</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">LinearSteadyStateDiffusionReactionPde</span><span class="o">&lt;</span><span class="mi">3</span><span class="o">&gt;</span> <span class="o">&gt;</span> <span class="n">p_oxygen_pde</span> <span class="o">=</span> <span class="n">LinearSteadyStateDiffusionReactionPde</span><span class="o">&lt;</span><span class="mi">3</span><span class="o">&gt;::</span><span class="n">Create</span><span class="p">();</span>
        <span class="n">units</span><span class="o">::</span><span class="n">quantity</span><span class="o">&lt;</span><span class="n">unit</span><span class="o">::</span><span class="n">diffusivity</span><span class="o">&gt;</span> <span class="n">oxygen_diffusivity</span><span class="p">(</span><span class="mf">1.e-6</span><span class="o">*</span><span class="n">unit</span><span class="o">::</span><span class="n">metre_squared_per_second</span><span class="p">);</span>
        <span class="n">p_oxygen_pde</span><span class="o">-&gt;</span><span class="n">SetIsotropicDiffusionConstant</span><span class="p">(</span><span class="n">oxygen_diffusivity</span><span class="p">);</span>
        <span class="n">units</span><span class="o">::</span><span class="n">quantity</span><span class="o">&lt;</span><span class="n">unit</span><span class="o">::</span><span class="n">rate</span><span class="o">&gt;</span> <span class="n">oxygen_consumption_rate</span><span class="p">(</span><span class="mf">1.e-6</span><span class="o">*</span><span class="n">unit</span><span class="o">::</span><span class="n">per_second</span><span class="p">);</span>
        <span class="n">p_oxygen_pde</span><span class="o">-&gt;</span><span class="n">SetContinuumLinearInUTerm</span><span class="p">(</span><span class="o">-</span><span class="n">oxygen_consumption_rate</span><span class="p">);</span>
        <span class="n">p_domain</span><span class="o">-&gt;</span><span class="n">GetFacet</span><span class="p">(</span><span class="n">DimensionalChastePoint</span><span class="o">&lt;</span><span class="mi">3</span><span class="o">&gt;</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span>
                                                     <span class="n">domain_height</span><span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">reference_length</span><span class="p">),</span>
                                                     <span class="n">domain_depth</span><span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">reference_length</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">SetLabel</span><span class="p">(</span><span class="s">"boundary_1"</span><span class="p">);</span>
        <span class="n">boost</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">DiscreteContinuumBoundaryCondition</span><span class="o">&lt;</span><span class="mi">3</span><span class="o">&gt;</span> <span class="o">&gt;</span> <span class="n">p_left_face_boundary</span> <span class="o">=</span> <span class="n">DiscreteContinuumBoundaryCondition</span><span class="o">&lt;</span><span class="mi">3</span><span class="o">&gt;::</span><span class="n">Create</span><span class="p">();</span>
        <span class="n">p_left_face_boundary</span><span class="o">-&gt;</span><span class="n">SetType</span><span class="p">(</span><span class="n">BoundaryConditionType</span><span class="o">::</span><span class="n">FACET</span><span class="p">);</span>
        <span class="n">p_left_face_boundary</span><span class="o">-&gt;</span><span class="n">SetDomain</span><span class="p">(</span><span class="n">p_domain</span><span class="p">);</span>
        <span class="n">p_left_face_boundary</span><span class="o">-&gt;</span><span class="n">SetValue</span><span class="p">(</span><span class="mf">10.0</span><span class="o">*</span><span class="n">unit</span><span class="o">::</span><span class="n">mole_per_metre_cubed</span><span class="p">);</span>
        <span class="n">p_left_face_boundary</span><span class="o">-&gt;</span><span class="n">SetLabelName</span><span class="p">(</span><span class="s">"boundary_1"</span><span class="p">);</span>
        <span class="n">boost</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">FiniteDifferenceSolver</span><span class="o">&lt;</span><span class="mi">3</span><span class="o">&gt;</span> <span class="o">&gt;</span> <span class="n">p_oxygen_solver</span> <span class="o">=</span> <span class="n">FiniteDifferenceSolver</span><span class="o">&lt;</span><span class="mi">3</span><span class="o">&gt;::</span><span class="n">Create</span><span class="p">();</span>
        <span class="n">p_oxygen_solver</span><span class="o">-&gt;</span><span class="n">SetPde</span><span class="p">(</span><span class="n">p_oxygen_pde</span><span class="p">);</span>
        <span class="n">p_oxygen_solver</span><span class="o">-&gt;</span><span class="n">SetGrid</span><span class="p">(</span><span class="n">p_grid</span><span class="p">);</span>
        <span class="n">p_oxygen_solver</span><span class="o">-&gt;</span><span class="n">AddBoundaryCondition</span><span class="p">(</span><span class="n">p_left_face_boundary</span><span class="p">);</span>
        <span class="n">p_oxygen_solver</span><span class="o">-&gt;</span><span class="n">SetLabel</span><span class="p">(</span><span class="s">"oxygen"</span><span class="p">);</span>
        <span class="n">p_oxygen_solver</span><span class="o">-&gt;</span><span class="n">SetFileHandler</span><span class="p">(</span><span class="n">p_handler</span><span class="p">);</span>
        <span class="n">p_oxygen_solver</span><span class="o">-&gt;</span><span class="n">SetFileName</span><span class="p">(</span><span class="s">"fd_solution.vti"</span><span class="p">);</span>
        <span class="n">p_oxygen_solver</span><span class="o">-&gt;</span><span class="n">SetWriteSolution</span><span class="p">(</span><span class="nb">true</span><span class="p">);</span>
        <span class="n">p_oxygen_solver</span><span class="o">-&gt;</span><span class="n">Setup</span><span class="p">();</span>
        <span class="n">p_oxygen_solver</span><span class="o">-&gt;</span><span class="n">Solve</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">};</span>

</code></pre></div>
          </div>
      </div>
    </div>
  </div>
</div>


  <div class="footer">
  <div class="container">
    <ul>
      <li><h5>Documentation</h5></li>
      <li><a href="https://jmsgrogan.github.io/MicrovesselChaste/documentation/getting-started.html">Getting Started</a></li>
      <li><a href="https://jmsgrogan.github.io/MicrovesselChaste/documentation/python-api/index.html">Python API</a></li>
      <li><a href="https://jmsgrogan.github.io/MicrovesselChaste/documentation/cpp-api/index.html">C++ API</a></li>
      <li><a href="https://jmsgrogan.github.io/MicrovesselChaste/documentation/tutorials.html">Tutorials</a></li>
    </ul>
    <ul>
      <li><h5>Download</h5></li>
        <li><a href="https://jmsgrogan.github.io/MicrovesselChaste/documentation/installation.html">Instructions</a></li>
    </ul>
    <ul>
      <li><h5>Community</h5></li>
      <li><a href="https://jmsgrogan.github.io/MicrovesselChaste/community/">Community</a></li>
      <li><a href="https://jmsgrogan.github.io/MicrovesselChaste/community/index.html#mailing-lists">Mailing Lists</a></li>
    </ul>
    <ul>
      <li><h5>Contribute</h5></li>
      <li><a href="https://jmsgrogan.github.io/MicrovesselChaste/contribute">How to Help</a></li>
      <li><a href="https://jmsgrogan.github.io/MicrovesselChaste/contribute/">Report an Issue</a></li>
    </ul>
    </div>
    <div class="container">
      <div class="copyright">
        <p style="float: left;"><br/>Copyright &copy; 2015-<span class="current-year"></span> University of Oxford<br/> Oxford, United Kingdom. Released under <a href="http://creativecommons.org/licenses/by/3.0/">Creative Commons Attribution 3.0 Unported License</a>.<br />
Source code for this website was modified from the <a href="https://www.scala-lang.org/">scala website</a> on <a href="https://www.scala-lang.org/">github</a>. <br />
See <a href="https://raw.github.com/scala/scala-lang/master/license.md">original license</a> for details. </p>
      </div>
      <div class="scala-logo-footer">
        <img src="https://jmsgrogan.github.io/MicrovesselChaste/resources/img/mvc_logo_25.png" alt="Microvessel Chaste Logo" />
      </div>
    </div> <!-- container -->
    </div> <!-- footer -->

    <!-- prettify  js -->
    <script src="https://jmsgrogan.github.io/MicrovesselChaste/resources/js/vendor/prettify/prettify.js" type="text/javascript" ></script>
    <script src="https://jmsgrogan.github.io/MicrovesselChaste/resources/js/vendor/prettify/lang-scala.js" type="text/javascript" ></script>

    <!-- jquery js -->
    <script src="https://jmsgrogan.github.io/MicrovesselChaste/resources/js/vendor/jquery-1.8.3.min.js" type="text/javascript" ></script>
    <script src="https://jmsgrogan.github.io/MicrovesselChaste/resources/js/vendor/jquery.stellar.min.js" type="text/javascript" ></script>
    <script src="https://jmsgrogan.github.io/MicrovesselChaste/resources/js/vendor/tweetMachine.min.js" type="text/javascript" ></script>

    <!-- modernizr js -->
    <script src="https://jmsgrogan.github.io/MicrovesselChaste/resources/js/vendor/modernizr-2.6.2-respond-1.1.0.min.js" type="text/javascript" ></script>

    <!-- retina js -->
    <script src="https://jmsgrogan.github.io/MicrovesselChaste/resources/js/vendor/retina.js" type="text/javascript" ></script>

    <!-- backstretch js -->
    <script src="https://jmsgrogan.github.io/MicrovesselChaste/resources/js/vendor/jquery.backstretch.min.js" type="text/javascript" ></script>

    <!-- Bootstrap JS -->
    <script src="https://jmsgrogan.github.io/MicrovesselChaste/resources/js/vendor/bootstrap.min.js" type="text/javascript" ></script>

    
    <!-- table of contents JS -->
    <script src="https://jmsgrogan.github.io/MicrovesselChaste/resources/js/vendor/toc.js" type="text/javascript" ></script>
    <script type="text/javascript">
      $(document).ready(function(){
        $('#toc').toc({exclude: 'h1, h5, h6', context: '', autoId: true, numerate: false});
        function moveScroller() {
          if ($(".sidebar").length == 0)
            return;
          var a = function() {
            var topOfScroll = $(window).scrollTop();
            var topOfSidebar = $(".sidebar").offset().top;
            var sidebarInner = $(".sidebar-inner");
            var bottomOfSidebarInner = $(".sidebar-inner").offset().top + $(".sidebar-inner").outerHeight();
            var topOfFooter = $(".footer").offset().top - 10;
            var footerHeight = $(".footer").outerHeight();
            if (topOfScroll > topOfSidebar) {
              if (bottomOfSidebarInner > topOfFooter) {
                sidebarInner.css({position:"fixed",bottom:footerHeight,top:""});
              } else {
                sidebarInner.css({position:"fixed",top:"10px",bottom:""});
              }
            } else {
              sidebarInner.css({position:"relative",top:""});
            }
          };
          $(window).scroll(a);a()
        }
        moveScroller();
      })
    </script>
    

    <!-- Custom javascript -->
    <script src="https://jmsgrogan.github.io/MicrovesselChaste/resources/js/main.js" type="text/javascript"></script>
  </body>
</html>

